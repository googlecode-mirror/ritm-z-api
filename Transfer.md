# Описание #
## Общий принцип работы интеграции ##

### 1.	Передача каталога интернет-магазина в информационную систему 	Ritm-Z ###

Данный процесс является начальным этапом интеграции и реализуется в следующем порядке:

•	каталог публикуется на сайте интернет-магазина по постоянному URL-адресу, согласованному с компанией Ritm-Z в виде XML-файла, и должен быть постоянно доступен по протоколу HTTP. Для реализации этого этапа разработчиком на стороне интернет-магазина создается php-скрипт, генерирующий XML-представление каталога в заданном формате;

•	формат файла каталога описан ниже и является расширением формата YML, широко используемого в настоящее время для осуществления информационного обмена;

•	робот Ritm-Z осуществляет HTTP-запрос по указанному URL и производит импорт опубликованных позиций каталога в свою информационную систему;

•	после первоначального заполнения каталога роботом системы Ritm-Z производится периодическое (утром в 6:00) обновление каталога интернет-магазина способом, аналогичным описанному в предыдущих пунктах.

### 2.	Передача данных о заказах интернет-магазина в систему Ritm-Z ###

Цель данного этапа интеграции — автоматизация сбора данных о заказах, принимаемых интернет-магазином. Процесс осуществляется в целом аналогично описанному в предыдущем этапе и производится  в следующем порядке:

•	разработчиком на стороне интернет-магазина создается php-скрипт, формирующий выборку заказов интернет-магазина за определенное время и представляющий эту выборку в виде XML (спецификация формата передачи заказов представлена в соответствующем разделе), либо генерацией массива данных определённого формата, и передача через soap. Скрипт размещается на сайте интернет-магазина по согласованному с компанией  Ritm-Z URL и должен быть постоянно доступен по протоколу HTTP;

•	робот системы Ritm-Z периодически направляет HTTP POST и GET-запрос, содержащий параметры, определяющие начальную и конечную даты выборки;

•	после получения ответа — выборки заказов в формате XML — робот системы Ritm-Z производит ее разбор и, в случае отсутствия в ответе сайта Клиента ошибок, вносит полученные заказы в систему Ritm-Z.

### 3.	Получение интернет-магазином актуальных состояний заказов ###

Технической базой этого и следующего этапов является использование технологии веб-сервисов (SOAP). Для каждого из этих этапов в системе Ritm-Z существует отдельный веб-сервис, доступный по протоколу HTTP и предназначенный для получения соответствующих данных в виде объектов.

Оба этапа, в отличие от предыдущих, инициируются на стороне интернет-магазина.

Цель данного этапа — получение информации о заказах интернет-магазина из системы Ritm-Z и ее актуализация на сайте.

Порядок реализации данного этапа можно описать следующим образом:

•	разработчиком на стороне интернет-магазина создается скрипт, осуществляющий вызов SOAP-функции веб-сервиса системы Ritm-Z ПолучитьЗаказы() с параметрами, определяющими начальную и конечную даты выборки. Описание порядка вызова функции и допустимых значений ее параметров представлено в соответствующем разделе;

•	при наличии ответа сервиса, не содержащего сообщений об ошибках, скрипт получает результат вызова функции в виде объекта (для php — StdClass) с определенным составом полей;

•	полученные данные используются скриптом интернет-магазина для последующего обновления данных о заказах.

Для упрощения реализации этого и следующего заказов (в частности, абстрагирования от прямого SOAP-вызова) разработана библиотека функций, порядок работы с которой описан в соответствующем разделе.

### 4.	Получение интернет-магазином актуальных остатков товаров на складах ###

Цель данного этапа — обновление в интернет-магазине данных по остаткам товаров Клиента на складах (по данным системы Ritm-Z).

Этот этап по порядку реализации и функционирования аналогичен предыдущему, за исключением вызываемой SOAP-функции (ПолучитьОстатки()) и ее параметров (перечни артикулов запрашиваемой номенклатуры и наименований складов).